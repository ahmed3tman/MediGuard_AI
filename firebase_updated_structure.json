{
  "_comment": "هيكل قاعدة البيانات المحدث - يدعم مزامنة البيانات بين الأجهزة",
  "_updated_structure": "إضافة قسم patients و criticalCases لكل مستخدم",

  "device_readings": {
    "DEVICE001": {
      "current": {
        "temperature": 36.8,
        "ecg": 75,
        "spo2": 98,
        "bloodPressure": {
          "systolic": 120,
          "diastolic": 80
        },
        "timestamp": 1641072000000,
        "deviceStatus": "connected"
      },
      "history": {
        "2024-01-01T10:00:00Z": {
          "temperature": 36.7,
          "ecg": 72,
          "spo2": 97,
          "bloodPressure": {
            "systolic": 118,
            "diastolic": 78
          }
        }
      }
    }
  },

  "users": {
    "doctor_user_id": {
      "name": "د. أحمد محمد",
      "email": "doctor@example.com",
      "createdAt": 1641072000000,
      "lastLoginAt": 1641072000000,

      "devices": {
        "DEVICE001": {
          "deviceId": "DEVICE001",
          "name": "Patient Room 101 Monitor",
          "readings": {
            "temperature": 36.8,
            "ecg": 75,
            "spo2": 98,
            "bloodPressure": {
              "systolic": 120,
              "diastolic": 80
            }
          },
          "lastUpdated": 1641072000000
        }
      },

      "patients": {
        "DEVICE001": {
          "deviceId": "DEVICE001",
          "patientName": "أحمد محمد علي",
          "age": 45,
          "gender": "male",
          "bloodType": "O+",
          "phoneNumber": "+201234567890",
          "chronicDiseases": ["diabetes", "hypertension"],
          "notes": "مريض يعاني من السكري والضغط المرتفع",
          "createdAt": "2024-01-01T10:00:00Z",
          "updatedAt": "2024-01-02T15:30:00Z"
        },
        "DEVICE002": {
          "deviceId": "DEVICE002",
          "patientName": "فاطمة أحمد",
          "age": 32,
          "gender": "female",
          "bloodType": "A+",
          "phoneNumber": "+201987654321",
          "chronicDiseases": [],
          "notes": "حالة عادية - فحص دوري",
          "createdAt": "2024-01-01T12:00:00Z",
          "updatedAt": "2024-01-01T12:00:00Z"
        }
      },

      "criticalCases": {
        "DEVICE003": {
          "deviceId": "DEVICE003",
          "name": "Emergency Room Monitor",
          "temperature": 38.5,
          "heartRate": 110,
          "spo2": 90,
          "bloodPressure": {
            "systolic": 160,
            "diastolic": 95
          },
          "ecgData": [],
          "lastUpdated": "2024-01-01T14:30:00Z"
        }
      }
    },

    "another_doctor_id": {
      "name": "د. سارة أحمد",
      "email": "sara@example.com",
      "createdAt": 1641072000000,
      "lastLoginAt": 1641072000000,

      "devices": {
        "DEVICE004": {
          "deviceId": "DEVICE004",
          "name": "ICU Monitor",
          "readings": {
            "temperature": 37.2,
            "ecg": 88,
            "spo2": 96,
            "bloodPressure": {
              "systolic": 130,
              "diastolic": 85
            }
          },
          "lastUpdated": 1641072000000
        }
      },

      "patients": {
        "DEVICE004": {
          "deviceId": "DEVICE004",
          "patientName": "محمد علي حسن",
          "age": 60,
          "gender": "male",
          "bloodType": "B+",
          "phoneNumber": "+201111222333",
          "chronicDiseases": ["heart_disease"],
          "notes": "مريض قلب - يحتاج متابعة دقيقة",
          "createdAt": "2024-01-01T08:00:00Z",
          "updatedAt": "2024-01-01T16:45:00Z"
        }
      },

      "criticalCases": {}
    }
  },

  "_instructions": {
    "data_sync_flow": [
      "1. عند تسجيل الدخول: تحميل جميع البيانات من Firebase",
      "2. عند إضافة بيانات جديدة: حفظ في Firebase + التخزين المحلي",
      "3. عند فقدان الاتصال: العمل بالبيانات المحلية",
      "4. عند عودة الاتصال: مزامنة البيانات المحلية مع Firebase"
    ],

    "patient_data_structure": {
      "path": "/users/{userId}/patients/{deviceId}",
      "description": "بيانات المرضى مرتبطة بكل جهاز طبي",
      "sync": "تتزامن بين جميع أجهزة الطبيب"
    },

    "critical_cases_structure": {
      "path": "/users/{userId}/criticalCases/{deviceId}",
      "description": "الحالات الطارئة التي تحتاج متابعة فورية",
      "sync": "تتزامن بين جميع أجهزة الطبيب"
    },

    "security_rules": {
      "patients": "يمكن للطبيب فقط الوصول لبيانات مرضاه",
      "criticalCases": "يمكن للطبيب فقط الوصول لحالاته الطارئة",
      "devices": "يمكن للطبيب فقط الوصول لأجهزته"
    }
  }
}
